# IMCAT UI 모듈 사용 가이드

> **모듈 로딩**: `IMCAT.use('모듈명')` 으로 동적 로드  
> **메모리 관리**: `IMCAT.view.registerInstance(instance)` 로 SPA 페이지 전환 시 자동 정리

---

## 목차

- [코어 API](#코어-api)
  - [DOM](#dom---dom-조작)
  - [EventBus](#eventbus---이벤트-버스)
  - [Router](#router---spa-라우팅)
  - [State](#state---상태-관리)
  - [Storage](#storage---로컬-저장소)
  - [Template](#template---템플릿-엔진)
  - [Security](#security---보안-유틸리티)
  - [Utils](#utils---유틸리티-함수)
  - [Loading](#loading---로딩-인디케이터)
  - [API](#api---http-클라이언트)
- [외장 모듈](#모듈-목록)

---

## 코어 API

코어 API는 `IMCAT` 전역 객체를 통해 직접 접근합니다.

### DOM - DOM 조작

```javascript
// 요소 선택
const el = IMCAT('#app');
const items = IMCAT('.item');

// 체이닝
IMCAT('#app')
  .addClass('active')
  .removeClass('hidden')
  .text('Hello World')
  .on('click', handler);

// 여러 요소 순회
IMCAT('.nav-link').each(link => {
  link.classList.add('active');
});

// 존재 확인
if (IMCAT('#element').length > 0) {
  // 요소 존재
}
```

**주요 메서드:**

| 메서드 | 설명 |
|--------|------|
| `.addClass(name)` | 클래스 추가 |
| `.removeClass(name)` | 클래스 제거 |
| `.toggleClass(name)` | 클래스 토글 |
| `.hasClass(name)` | 클래스 존재 여부 |
| `.text([value])` | 텍스트 조회/설정 |
| `.html([value])` | HTML 조회/설정 |
| `.val([value])` | 값 조회/설정 |
| `.attr(name, [value])` | 속성 조회/설정 |
| `.data(key, [value])` | data-* 속성 |
| `.on(event, handler)` | 이벤트 리스너 추가 |
| `.off(event, handler)` | 이벤트 리스너 제거 |
| `.show()` / `.hide()` | 표시/숨김 |
| `.append(content)` | 자식 추가 |
| `.remove()` | 요소 제거 |
| `.find(selector)` | 하위 요소 찾기 |
| `.closest(selector)` | 상위 요소 찾기 |
| `.parent()` | 부모 요소 |
| `.children()` | 자식 요소 |
| `.each(callback)` | 각 요소 순회 |

---

### EventBus - 이벤트 버스

```javascript
// 이벤트 구독
IMCAT.on('user:login', (user) => {
  console.log('로그인:', user);
});

// 일회성 구독
IMCAT.once('data:loaded', (data) => {
  console.log('데이터 로드 완료');
});

// 이벤트 발행
IMCAT.emit('user:login', { name: '홍길동' });

// 구독 취소
IMCAT.off('user:login', handler);
```

---

### Router - SPA 라우팅

```javascript
// 페이지 네비게이션
IMCAT.view.navigate('views/home.html');

// URL 파라미터 가져오기
const params = IMCAT.view.params();  // { id: '123', page: '1' }

// 훅 등록
IMCAT.view.beforeLoad((path) => {
  console.log('로드 시작:', path);
  return true;  // false 반환 시 로드 취소
});

IMCAT.view.afterLoad((path) => {
  console.log('로드 완료:', path);
});

IMCAT.view.onError((error, path) => {
  console.error('로드 실패:', error);
});

// 인스턴스 등록 (SPA 메모리 관리)
IMCAT.view.registerInstance(instance);

// 컨테이너 설정
IMCAT.view.setContainer('#app-content');
```

**HTML 속성 기반 라우팅:**

```html
<!-- catui-href: 클릭 시 자동 네비게이션 -->
<a href="#" catui-href="views/home.html">홈</a>
<a href="#" catui-href="views/about.html">소개</a>

<!-- catui-target: 렌더링 타겟 지정 -->
<body catui-target="app-content">
  <div id="app-content"></div>
</body>
```

---

### State - 상태 관리

```javascript
// 로컬 상태 생성
const state = IMCAT.state.create({
  count: 0,
  user: null
});

// 상태 변경 감지 (watch)
state.watch('count', (newVal, oldVal) => {
  console.log(`count: ${oldVal} -> ${newVal}`);
});

// 상태 변경 (자동 감지됨)
state.count++;
state.user = { name: '홍길동' };

// computed 값
state.compute('double', () => state.count * 2);

// 배치 업데이트
state.batch(() => {
  state.count = 10;
  state.user = { name: 'Kim' };
});

// 상태 조회/설정
state.getState();
state.setState({ count: 0 });

// 초기화
state.reset();

// 정리
state.destroy();
```

**전역 상태:**

```javascript
// 전역 상태 사용 (앱 전체 공유)
const store = IMCAT.globalState.use('storeName', { theme: 'light' });
store.theme = 'dark';  // 자동 감지

// 다른 곳에서 동일한 스토어 접근
const store2 = IMCAT.globalState.use('storeName');
console.log(store2.theme);  // 'dark'
```

---

### Storage - 로컬 저장소

```javascript
// 저장
IMCAT.storage.set('user', { name: '홍길동', id: 1 });

// TTL (만료 시간) 설정
IMCAT.storage.set('token', 'abc123', { expires: 3600 });  // 1시간

// sessionStorage 사용
IMCAT.storage.set('temp', 'data', { storage: 'session' });

// 가져오기
const user = IMCAT.storage.get('user');
const count = IMCAT.storage.get('count', 0);  // 기본값 지정

// 삭제
IMCAT.storage.remove('user');

// 존재 확인
IMCAT.storage.has('user');

// 전체 삭제
IMCAT.storage.clear();
```

---

### Template - 템플릿 엔진

```javascript
// 기본 렌더링 (자동 XSS 방어)
const html = IMCAT.template.render(
  'Hello {{name}}!',
  { name: 'World' }
);
// 'Hello World!'

// Raw 렌더링 (이스케이프 없음 - 신뢰된 데이터만!)
const html = IMCAT.template.renderRaw(
  '<div>{{content}}</div>',
  { content: '<b>Bold</b>' }
);

// 조건부 렌더링
const html = IMCAT.template.if(
  user.isAdmin,
  '<button>관리자</button>'
);

// 리스트 렌더링
const html = IMCAT.template.each(
  items,
  '<li>{{name}} - {{price}}원</li>'
);
```

---

### Security - 보안 유틸리티

```javascript
// HTML 이스케이프 (XSS 방어)
const safe = IMCAT.escape('<script>alert("XSS")</script>');
// '&lt;script&gt;alert("XSS")&lt;/script&gt;'

// HTML 새니타이징 (위험 태그 제거)
const clean = IMCAT.sanitize(userInput);

// 경로 검증
const isValid = IMCAT.security.validatePath('views/home.html');
// true

IMCAT.security.validatePath('../../../etc/passwd');
// false (경로 순회 차단)
```

---

### Utils - 유틸리티 함수

```javascript
// 타입 체크
IMCAT.isString(value);
IMCAT.isNumber(value);
IMCAT.isArray(value);
IMCAT.isObject(value);
IMCAT.isFunction(value);

// 랜덤 ID 생성
const id = IMCAT.randomId('prefix');  // 'prefix_a1b2c3d4'

// 디바운스
const debouncedFn = IMCAT.debounce(fn, 300);

// 스로틀
const throttledFn = IMCAT.throttle(fn, 100);

// 객체 병합 (깊은 복사)
const merged = IMCAT.extend({}, obj1, obj2);

// 깊은 복사
const copy = IMCAT.clone(obj);
```

---

### Loading - 로딩 인디케이터

```javascript
// 로딩 표시
IMCAT.loading.show('데이터 로딩 중...');

// 로딩 숨김
IMCAT.loading.hide();

// 표시 여부 확인
IMCAT.loading.isVisible();

// 콘텐츠 변경
IMCAT.loading.setContent('<div>커스텀 로딩</div>');
```

---

### API - HTTP 클라이언트

```javascript
// GET 요청
const data = await IMCAT.api.get('/api/users');

// POST 요청
const result = await IMCAT.api.post('/api/users', {
  name: '홍길동',
  email: 'hong@example.com'
});

// PUT 요청
await IMCAT.api.put('/api/users/1', { name: '김철수' });

// DELETE 요청
await IMCAT.api.delete('/api/users/1');

// 옵션
const data = await IMCAT.api.get('/api/data', {
  headers: { 'Authorization': 'Bearer token' },
  timeout: 5000
});

// 인터셉터
IMCAT.api.interceptors.request((config) => {
  config.headers['Authorization'] = `Bearer ${getToken()}`;
  return config;
});

IMCAT.api.interceptors.response(
  (response) => response,
  (error) => { handleError(error); throw error; }
);
```

---

### Animation - 애니메이션

```javascript
// 요소 애니메이션
IMCAT.animate('#element')
  .fadeIn(300)
  .then(() => console.log('완료'));

IMCAT.animate('#element').fadeOut(300);
IMCAT.animate('#element').slideDown(300);
IMCAT.animate('#element').slideUp(300);

// 커스텀 애니메이션
IMCAT.animate('#element').custom({
  from: { opacity: 0, transform: 'translateY(20px)' },
  to: { opacity: 1, transform: 'translateY(0)' },
  duration: 500,
  easing: 'easeOutCubic'
});
```

---

### URL - URL 유틸리티

```javascript
// 쿼리 스트링 파싱
const params = IMCAT.url.parse('?id=123&page=1');
// { id: '123', page: '1' }

// 객체를 쿼리 스트링으로
const query = IMCAT.url.stringify({ id: 123, page: 1 });
// 'id=123&page=1'

// 특정 파라미터 가져오기
const id = IMCAT.url.getParam('id');

// 파라미터 설정 (URL 변경)
IMCAT.url.setParam('page', '2');
```

---

### Form - 폼 검증

```javascript
// 폼 검증기 생성
const validator = IMCAT.form.create('#myForm', {
  rules: {
    email: { required: true, email: true },
    password: { required: true, minLength: 8 },
    age: { required: true, min: 18, max: 100 }
  },
  messages: {
    email: {
      required: '이메일을 입력하세요',
      email: '올바른 이메일 형식이 아닙니다'
    }
  },
  onValid: (data) => console.log('유효:', data),
  onInvalid: (errors) => console.log('오류:', errors)
});

// 수동 검증
const isValid = validator.validate();

// 특정 필드 검증
const fieldValid = validator.validateField('email');

// 오류 가져오기
const errors = validator.getErrors();

// 리셋
validator.reset();

// 정리
validator.destroy();
```

---

## 모듈 목록

| 모듈명 | 설명 | 포함 컴포넌트 |
|--------|------|---------------|
| `theme` | 테마 관리 | Theme |
| `overlays` | 오버레이 | Modal, Drawer, Offcanvas, Lightbox |
| `feedback` | 피드백 | Toast, Notification, ProgressTracker, Skeleton |
| `dropdown` | 드롭다운 | Dropdown |
| `forms` | 폼 확장 | FileUpload, Rating, SignaturePad, FormWizard |
| `tooltips` | 툴팁/팝오버 | Tooltip, Popover |
| `navigation` | 네비게이션 | Tabs, Accordion, Collapse, MegaMenu, TreeView |
| `pagination` | 페이지네이션 | Pagination, DataPaginator |
| `carousel` | 캐러셀 | Carousel, Lightbox |
| `stepper` | 단계 표시 | Stepper, VerticalStepper |
| `selectors` | 선택자 | Autocomplete, MultiSelect, RangeSlider |
| `pickers` | 피커 | DatePicker, TimePicker, ColorPicker |
| `scroll` | 스크롤 | VirtualScroll, Scrollspy, InfiniteScroll |
| `data-viz` | 데이터 시각화 | DataTable, Chart, Masonry, Kanban, Calendar |
| `advanced-ui` | 고급 UI | SplitPane, QRCode, CopyToClipboard |
| `text-editors` | 텍스트 에디터 | RichTextEditor, MarkdownEditor |
| `social` | 소셜 | ChatUI, Comments, Share, Reactions |
| `security-input` | 보안 입력 | OTPInput, PINInput |
| `media-viewer` | 미디어 뷰어 | VideoPlayer, AudioPlayer, ImageViewer |
| `live-status` | 실시간 상태 | OnlineStatus, TypingIndicator |

---

## 기본 사용 패턴

```javascript
// 1. 모듈 로드
const Module = await IMCAT.use('모듈명');

// 2. 인스턴스 생성
const instance = new Module.Component(selector, options);

// 3. SPA 메모리 관리 등록
IMCAT.view.registerInstance(instance);
```

---

## 1. Theme

```javascript
const Theme = await IMCAT.use('theme');

const theme = new Theme({
  defaultTheme: 'system',     // 'light' | 'dark' | 'system'
  storageKey: 'imcat-theme',
  transition: 'fade',         // 'none' | 'fade' | 'slide' | 'circle'
  transitionDuration: 300,
  onChange: (name, resolved) => console.log(name, resolved)
});

// 메서드
theme.set('dark');            // 테마 설정
theme.toggle();               // 라이트/다크 토글
theme.getResolved();          // 실제 적용된 테마
theme.destroy();
```

---

## 2. Overlays

```javascript
const Overlays = await IMCAT.use('overlays');

// Modal
const modal = new Overlays.Modal({
  title: '제목',
  content: '<p>내용</p>',
  size: 'md',                 // 'sm' | 'md' | 'lg' | 'xl'
  centered: true,
  buttons: [
    { text: '취소', variant: 'secondary', action: () => modal.hide() },
    { text: '확인', variant: 'primary', action: () => save() }
  ]
});
modal.show();

// 정적 메서드
await Overlays.Modal.confirm({ title: '확인', message: '삭제?' });
await Overlays.Modal.alert({ title: '알림', message: '완료!' });

// Drawer
const drawer = new Overlays.Drawer({
  position: 'right',          // 'left' | 'right' | 'top' | 'bottom'
  title: '필터',
  content: '<form>...</form>',
  width: '400px'
});
drawer.show();
```

---

## 3. Feedback

```javascript
const Feedback = await IMCAT.use('feedback');

// Toast (정적)
Feedback.Toast.success('저장되었습니다!');
Feedback.Toast.error('오류 발생');
Feedback.Toast.warning('주의');
Feedback.Toast.info('안내');

// Notification (정적)
Feedback.Notification.init('top-right');
Feedback.Notification.show({
  title: '알림',
  message: '새 메시지',
  type: 'info',
  duration: 5000
});

// ProgressTracker
const tracker = new Feedback.ProgressTracker('#progress', {
  steps: ['주문', '결제', '배송', '완료'],
  current: 0
});
tracker.next();               // 다음 단계
tracker.goTo(2);              // 특정 단계로

// Skeleton
const skeleton = new Feedback.Skeleton('#loading', {
  type: 'card',               // 'text' | 'avatar' | 'card' | 'image' | 'list'
  lines: 3
});
```

---

## 4. Dropdown

```javascript
const Dropdown = await IMCAT.use('dropdown');

const dropdown = new Dropdown('#menuBtn', {
  items: [
    { text: '프로필', icon: 'person', action: () => {} },
    { text: '설정', icon: 'settings' },
    { type: 'divider' },
    { text: '로그아웃', icon: 'logout', danger: true }
  ],
  position: 'bottom',         // 'top' | 'bottom' | 'left' | 'right'
  align: 'end',               // 'start' | 'center' | 'end'
  openOnHover: false,
  onSelect: (item) => console.log(item)
});
```

---

## 5. Forms

```javascript
const Forms = await IMCAT.use('forms');

// FileUpload
const upload = new Forms.FileUpload('#file', {
  accept: 'image/*',
  multiple: true,
  maxSize: 5 * 1024 * 1024,
  onChange: (files) => console.log(files)
});

// Rating
const rating = new Forms.Rating('#rating', {
  max: 5,
  value: 0,
  onChange: (val) => console.log(val)
});

// SignaturePad
const pad = new Forms.SignaturePad('#signature', {
  width: 400,
  height: 200,
  penColor: '#000'
});
pad.toDataURL();              // 이미지 데이터 URL

// FormWizard
const wizard = new Forms.FormWizard('#wizard', {
  steps: [
    { title: 'Step 1', content: '<form>...</form>' },
    { title: 'Step 2', content: '<form>...</form>' }
  ],
  onComplete: () => console.log('완료')
});
```

---

## 6. Tooltips

```javascript
const Tooltips = await IMCAT.use('tooltips');

// Tooltip
const tooltip = new Tooltips.Tooltip('#btn', {
  content: '도움말 내용',
  placement: 'top',           // 'top' | 'bottom' | 'left' | 'right'
  trigger: 'hover'            // 'hover' | 'focus' | 'click'
});

// data 속성으로 자동 초기화
// <button data-tooltip="내용" data-placement="top">버튼</button>
Tooltips.initAll();

// Popover
const popover = new Tooltips.Popover('#info', {
  title: '상세 정보',
  content: '<p>내용</p>',
  placement: 'bottom'
});
```

---

## 7. Navigation

```javascript
const Navigation = await IMCAT.use('navigation');

// Tabs (HTML 구조: [role="tablist"], [role="tab"], [role="tabpanel"])
const tabs = new Navigation.Tabs('#tabs', {
  activeIndex: 0,
  onChange: (index) => console.log(index)
});

// Accordion (HTML: .accordion__item > .accordion__header + .accordion__content)
const accordion = new Navigation.Accordion('#accordion', {
  multiple: false,
  expandFirst: true
});
accordion.expand(0);
accordion.collapse(0);
accordion.toggle(0);

// Collapse
const collapse = new Navigation.Collapse('#content', { expanded: false });
collapse.toggle();

// MegaMenu
const megamenu = new Navigation.MegaMenu('#nav', { trigger: 'hover' });

// TreeView
const tree = new Navigation.TreeView('#tree', {
  onNodeClick: (node) => console.log(node)
});
```

---

## 8. Pagination

```javascript
const PaginationModule = await IMCAT.use('pagination');

// Pagination
const pagination = new PaginationModule.Pagination('#paging', {
  totalItems: 100,
  itemsPerPage: 10,
  showInfo: true,
  align: 'center',
  onChange: (pageData) => loadData(pageData.startIndex, pageData.endIndex)
});

// DataPaginator (데이터 + 렌더링 + 페이지네이션 통합)
const paginator = new PaginationModule.DataPaginator({
  container: '#list',
  data: dataArray,
  itemsPerPage: 10,
  renderItem: (item, idx) => `<div>${item.name}</div>`
});
paginator.filter(item => item.active);
paginator.search('검색어', ['name', 'email']);
```

---

## 9. Carousel

```javascript
const CarouselModule = await IMCAT.use('carousel');

const carousel = new CarouselModule.Carousel('#slider', {
  items: [
    { src: 'img1.jpg', title: '제목1' },
    { content: '<div>커스텀</div>' }
  ],
  autoplay: true,
  autoplaySpeed: 5000,
  effect: 'fade',             // 'slide' | 'fade' | 'scale' | 'flip' | 'cube'
  slidesToShow: 1,
  responsive: [
    { breakpoint: 768, settings: { slidesToShow: 2 } }
  ],
  onSlideChange: (curr, prev) => console.log(curr)
});

carousel.next();
carousel.prev();
carousel.goTo(2);

// Lightbox
const lightbox = new CarouselModule.Lightbox({
  selector: 'img[data-lightbox]'
});
```

---

## 10. Stepper

```javascript
const StepperModule = await IMCAT.use('stepper');

// Stepper
const stepper = new StepperModule.Stepper('#stepper', {
  steps: [
    { title: 'Step 1', icon: 'person' },
    { title: 'Step 2', icon: 'settings' },
    { title: '완료', icon: 'check' }
  ],
  orientation: 'horizontal',
  linear: false,
  onChange: (step) => console.log(step)
});
stepper.next();
stepper.complete(0);

// VerticalStepper (인라인 콘텐츠)
const vStepper = new StepperModule.VerticalStepper('#vstepper', {
  steps: [
    { title: 'Step 1', content: '<form>...</form>' },
    { title: 'Step 2', content: '<form>...</form>' }
  ],
  editable: true
});
```

---

## 11-20. 기타 모듈

### Selectors

```javascript
const Selectors = await IMCAT.use('selectors');
const auto = new Selectors.Autocomplete('#search', {
  source: ['Apple', 'Banana'],  // 또는 async (query) => fetch(...)
  onSelect: (item) => console.log(item)
});
```

### Pickers

```javascript
const Pickers = await IMCAT.use('pickers');
const datePicker = new Pickers.DatePicker('#date', { format: 'YYYY-MM-DD' });
const timePicker = new Pickers.TimePicker('#time', { format: 'HH:mm' });
const colorPicker = new Pickers.ColorPicker('#color', { defaultColor: '#3b82f6' });
```

### Scroll

```javascript
const Scroll = await IMCAT.use('scroll');
const virtualScroll = new Scroll.VirtualScroll('#list', {
  items: largeArray,
  itemHeight: 50,
  renderItem: (item, i) => `<div>${item.name}</div>`
});
```

### Data-Viz

```javascript
const DataViz = await IMCAT.use('data-viz');
const table = new DataViz.DataTable('#table', {
  data: users,
  columns: [
    { key: 'name', title: '이름', sortable: true },
    { key: 'email', title: '이메일' }
  ],
  paginate: true
});
```

### Advanced-UI

```javascript
const AdvancedUI = await IMCAT.use('advanced-ui');
const split = new AdvancedUI.SplitPane('#editor', {
  direction: 'horizontal',
  initialSizes: [30, 70]
});
```

### Text-Editors

```javascript
const TextEditors = await IMCAT.use('text-editors');
const editor = new TextEditors.RichTextEditor('#editor', {
  onChange: (html) => console.log(html)
});
editor.getContent();
editor.setContent('<p>내용</p>');
```

### Social

```javascript
const Social = await IMCAT.use('social');
const chat = new Social.ChatUI('#chat', {
  currentUser: { id: 'user1', name: '나' },
  onSend: (msg) => sendToServer(msg)
});
chat.addMessage({ user: 'other', text: '안녕!' });
```

### Security-Input

```javascript
const SecurityInput = await IMCAT.use('security-input');
const otp = new SecurityInput.OTPInput('#otp', {
  length: 6,
  onComplete: (code) => verifyOTP(code)
});
```

### Media-Viewer

```javascript
const MediaViewer = await IMCAT.use('media-viewer');
const player = new MediaViewer.VideoPlayer('#video', {
  src: 'video.mp4',
  customControls: true
});
```

### Live-Status

```javascript
const LiveStatus = await IMCAT.use('live-status');
const status = new LiveStatus.OnlineStatus('#avatar', {
  status: 'online',           // 'online' | 'offline' | 'away' | 'busy'
  pulse: true
});
status.setStatus('away');
```

---

## 공통 패턴

### 인스턴스 등록 (필수)

```javascript
const instance = new Module.Component(selector, options);
IMCAT.view.registerInstance(instance);  // SPA 페이지 전환 시 자동 destroy
```

### 수동 정리

```javascript
instance.destroy();  // 수동으로 정리할 때
```

### 옵션 구조

```javascript
{
  // 기능 옵션
  option1: value,
  
  // 콜백
  onChange: (data) => {},
  onDestroy: () => {}
}
```

---

## 실전 예제 - 여러 모듈 조합

### 예제 1: 사용자 관리 대시보드

**사용 모듈:** DataTable + Modal + Toast + Pagination

```javascript
// 모듈 로드
const [DataViz, Overlays, Feedback, PaginationModule] = await Promise.all([
  IMCAT.use('data-viz'),
  IMCAT.use('overlays'),
  IMCAT.use('feedback'),
  IMCAT.use('pagination')
]);

// 상태 관리
const state = IMCAT.state.create({
  users: [],
  selectedUser: null,
  currentPage: 1
});

// DataTable 생성
const table = new DataViz.DataTable('#userTable', {
  data: state.users,
  columns: [
    { key: 'id', title: 'ID', sortable: true },
    { key: 'name', title: '이름', sortable: true },
    { key: 'email', title: '이메일' },
    { 
      key: 'actions', 
      title: '관리',
      render: (_, row) => `
        <button class="btn btn--sm btn--primary" data-action="edit" data-id="${row.id}">수정</button>
        <button class="btn btn--sm btn--danger" data-action="delete" data-id="${row.id}">삭제</button>
      `
    }
  ],
  selectable: true,
  onRowClick: (row) => {
    state.selectedUser = row;
  }
});

// 테이블 액션 이벤트
document.getElementById('userTable').addEventListener('click', async (e) => {
  const btn = e.target.closest('[data-action]');
  if (!btn) return;
  
  const action = btn.dataset.action;
  const id = btn.dataset.id;
  const user = state.users.find(u => u.id == id);
  
  if (action === 'edit') {
    // 수정 모달 표시
    const modal = new Overlays.Modal({
      title: '사용자 수정',
      content: `
        <form id="editForm">
          <div class="form-group">
            <label>이름</label>
            <input type="text" name="name" value="${IMCAT.escape(user.name)}" class="form-control">
          </div>
          <div class="form-group">
            <label>이메일</label>
            <input type="email" name="email" value="${IMCAT.escape(user.email)}" class="form-control">
          </div>
        </form>
      `,
      buttons: [
        { text: '취소', variant: 'secondary', action: () => modal.hide() },
        { text: '저장', variant: 'primary', action: async () => {
          const form = document.getElementById('editForm');
          const formData = new FormData(form);
          
          try {
            await IMCAT.api.put(`/api/users/${id}`, Object.fromEntries(formData));
            Feedback.Toast.success('저장되었습니다!');
            modal.hide();
            loadUsers();  // 목록 새로고침
          } catch (err) {
            Feedback.Toast.error('저장 실패: ' + err.message);
          }
        }}
      ]
    });
    modal.show();
    IMCAT.view.registerInstance(modal);
    
  } else if (action === 'delete') {
    // 삭제 확인
    const confirmed = await Overlays.Modal.confirm({
      title: '삭제 확인',
      message: `정말 "${user.name}"을(를) 삭제하시겠습니까?`,
      confirmText: '삭제',
      cancelText: '취소'
    });
    
    if (confirmed) {
      try {
        await IMCAT.api.delete(`/api/users/${id}`);
        Feedback.Toast.success('삭제되었습니다!');
        loadUsers();
      } catch (err) {
        Feedback.Toast.error('삭제 실패');
      }
    }
  }
});

// 데이터 로드 함수
async function loadUsers() {
  IMCAT.loading.show('사용자 목록 로딩 중...');
  try {
    const data = await IMCAT.api.get('/api/users');
    state.users = data;
    table.setData(data);
  } finally {
    IMCAT.loading.hide();
  }
}

// 인스턴스 등록
IMCAT.view.registerInstance(table);

// 초기 로드
loadUsers();
```

---

### 예제 2: 상품 목록 페이지

**사용 모듈:** Carousel + Pagination + Autocomplete + DatePicker + Modal

```javascript
// 모듈 병렬 로드
const [Carousel, Pagination, Selectors, Pickers, Overlays] = await Promise.all([
  IMCAT.use('carousel'),
  IMCAT.use('pagination'),
  IMCAT.use('selectors'),
  IMCAT.use('pickers'),
  IMCAT.use('overlays')
]);

// 상품 데이터
let products = [];
let filteredProducts = [];

// 히어로 배너 캐러셀
const heroCarousel = new Carousel.Carousel('#heroBanner', {
  items: [
    { src: 'banner1.jpg', title: '신상품 출시' },
    { src: 'banner2.jpg', title: '여름 세일' },
    { src: 'banner3.jpg', title: '무료 배송' }
  ],
  autoplay: true,
  autoplaySpeed: 5000,
  effect: 'fade'
});

// 상품 검색 자동완성
const searchAutocomplete = new Selectors.Autocomplete('#productSearch', {
  source: async (query) => {
    const results = await IMCAT.api.get(`/api/products/search?q=${query}`);
    return results.map(p => ({ label: p.name, value: p.id }));
  },
  minLength: 2,
  onSelect: (item) => {
    showProductDetail(item.value);
  }
});

// 등록일 필터
const dateFilter = new Pickers.DatePicker('#dateFilter', {
  format: 'YYYY-MM-DD',
  onChange: (date) => {
    filterProducts({ date });
  }
});

// 상품 목록 페이지네이션
const paginator = new Pagination.DataPaginator({
  container: '#productList',
  data: products,
  itemsPerPage: 12,
  renderItem: (product) => `
    <div class="product-card" data-id="${product.id}">
      <img src="${IMCAT.escape(product.image)}" alt="${IMCAT.escape(product.name)}">
      <h3>${IMCAT.escape(product.name)}</h3>
      <p class="price">${product.price.toLocaleString()}원</p>
      <button class="btn btn--primary btn--sm" onclick="addToCart(${product.id})">
        장바구니
      </button>
    </div>
  `,
  onPageChange: (pageData) => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
});

// 상품 상세 모달
async function showProductDetail(productId) {
  const product = await IMCAT.api.get(`/api/products/${productId}`);
  
  const modal = new Overlays.Modal({
    title: product.name,
    size: 'lg',
    content: `
      <div class="product-detail">
        <img src="${product.image}" alt="${product.name}">
        <div class="info">
          <p class="description">${product.description}</p>
          <p class="price">${product.price.toLocaleString()}원</p>
          <div class="quantity">
            <label>수량:</label>
            <input type="number" id="qty" value="1" min="1" max="99">
          </div>
        </div>
      </div>
    `,
    buttons: [
      { text: '닫기', variant: 'secondary', action: () => modal.hide() },
      { text: '장바구니 담기', variant: 'primary', action: () => {
        const qty = document.getElementById('qty').value;
        addToCart(productId, qty);
        modal.hide();
      }}
    ]
  });
  modal.show();
  IMCAT.view.registerInstance(modal);
}

// 필터 함수
function filterProducts(filters) {
  filteredProducts = products.filter(p => {
    if (filters.date && p.createdAt < filters.date) return false;
    if (filters.category && p.category !== filters.category) return false;
    return true;
  });
  paginator.setData(filteredProducts);
}

// 인스턴스 일괄 등록
[heroCarousel, searchAutocomplete, dateFilter, paginator].forEach(inst => {
  IMCAT.view.registerInstance(inst);
});
```

---

### 예제 3: 게시판 작성 페이지

**사용 모듈:** RichTextEditor + FileUpload + FormWizard + Toast

```javascript
const [TextEditors, Forms, Feedback] = await Promise.all([
  IMCAT.use('text-editors'),
  IMCAT.use('forms'),
  IMCAT.use('feedback')
]);

// 에디터
const editor = new TextEditors.RichTextEditor('#content', {
  placeholder: '내용을 입력하세요...',
  toolbar: ['bold', 'italic', 'underline', '|', 'heading', 'quote', '|', 'ul', 'ol', '|', 'link', 'image'],
  onChange: (html) => {
    // 자동 저장
    IMCAT.storage.set('draft_content', html);
  }
});

// 파일 업로드
const fileUpload = new Forms.FileUpload('#attachments', {
  accept: 'image/*,.pdf,.doc,.docx',
  multiple: true,
  maxSize: 10 * 1024 * 1024,  // 10MB
  maxFiles: 5,
  onChange: (files) => {
    console.log('첨부 파일:', files.length);
  },
  onError: (error) => {
    Feedback.Toast.error(error.message);
  }
});

// 단계별 폼 (긴 폼인 경우)
const wizard = new Forms.FormWizard('#postWizard', {
  steps: [
    {
      title: '기본 정보',
      content: `
        <div class="form-group">
          <label>제목 *</label>
          <input type="text" name="title" class="form-control" required>
        </div>
        <div class="form-group">
          <label>카테고리</label>
          <select name="category" class="form-control">
            <option value="general">일반</option>
            <option value="notice">공지</option>
            <option value="qna">Q&A</option>
          </select>
        </div>
      `,
      validate: () => {
        const title = document.querySelector('[name="title"]').value;
        if (!title.trim()) {
          Feedback.Toast.warning('제목을 입력하세요');
          return false;
        }
        return true;
      }
    },
    {
      title: '내용 작성',
      content: `<div id="content"></div>`
    },
    {
      title: '첨부 파일',
      content: `<div id="attachments"></div>`
    },
    {
      title: '미리보기',
      content: `<div id="preview"></div>`
    }
  ],
  onStepChange: (step) => {
    if (step === 3) {
      // 미리보기 업데이트
      document.getElementById('preview').innerHTML = `
        <h2>${document.querySelector('[name="title"]').value}</h2>
        <div>${editor.getContent()}</div>
        <p>첨부 파일: ${fileUpload.getFiles().length}개</p>
      `;
    }
  },
  onComplete: async () => {
    const formData = new FormData();
    formData.append('title', document.querySelector('[name="title"]').value);
    formData.append('category', document.querySelector('[name="category"]').value);
    formData.append('content', editor.getContent());
    
    fileUpload.getFiles().forEach(file => {
      formData.append('files', file);
    });
    
    try {
      IMCAT.loading.show('게시글 등록 중...');
      await IMCAT.api.post('/api/posts', formData);
      Feedback.Toast.success('게시글이 등록되었습니다!');
      IMCAT.storage.remove('draft_content');  // 임시저장 삭제
      IMCAT.view.navigate('views/board/list.html');
    } catch (err) {
      Feedback.Toast.error('등록 실패: ' + err.message);
    } finally {
      IMCAT.loading.hide();
    }
  }
});

// 임시저장 복원
const draft = IMCAT.storage.get('draft_content');
if (draft) {
  editor.setContent(draft);
  Feedback.Toast.info('임시저장된 내용을 불러왔습니다.');
}

// 인스턴스 등록
[editor, fileUpload, wizard].forEach(inst => {
  IMCAT.view.registerInstance(inst);
});
```

---

### 예제 4: 실시간 채팅 + 알림

**사용 모듈:** ChatUI + Notification + OnlineStatus + Toast

```javascript
const [Social, Feedback, LiveStatus] = await Promise.all([
  IMCAT.use('social'),
  IMCAT.use('feedback'),
  IMCAT.use('live-status')
]);

// 현재 사용자
const currentUser = { id: 'user1', name: '나', avatar: '/avatars/me.jpg' };

// 채팅 UI
const chat = new Social.ChatUI('#chatContainer', {
  currentUser,
  showTimestamp: true,
  showAvatar: true,
  onSend: async (message) => {
    try {
      // 서버로 메시지 전송
      await IMCAT.api.post('/api/chat/send', { 
        roomId: currentRoomId,
        message 
      });
    } catch (err) {
      Feedback.Toast.error('메시지 전송 실패');
    }
  },
  onTyping: () => {
    // 타이핑 상태 전송
    socket.emit('typing', { roomId: currentRoomId, userId: currentUser.id });
  }
});

// 온라인 상태 표시
const onlineStatus = new LiveStatus.OnlineStatus('#userStatus', {
  status: 'online',
  pulse: true
});

// 알림 초기화
Feedback.Notification.init('top-right');

// 이벤트 버스로 실시간 이벤트 처리
IMCAT.on('chat:message', (data) => {
  // 새 메시지 수신
  chat.addMessage({
    user: data.sender,
    text: data.message,
    timestamp: data.timestamp
  });
  
  // 알림 표시 (현재 창이 포커스 아닐 때)
  if (document.hidden) {
    Feedback.Notification.show({
      title: `${data.sender.name}님의 메시지`,
      message: data.message.substring(0, 50) + '...',
      type: 'info',
      duration: 5000,
      actions: [{ 
        text: '보기', 
        onClick: () => {
          window.focus();
          document.getElementById('chatContainer').scrollIntoView();
        }
      }]
    });
  }
});

IMCAT.on('user:status', (data) => {
  // 다른 사용자 상태 변경
  if (data.userId === currentUser.id) {
    onlineStatus.setStatus(data.status);
  }
});

IMCAT.on('chat:typing', (data) => {
  // 타이핑 인디케이터 표시
  chat.showTyping(data.userName);
});

// WebSocket 연결 (예시)
const socket = new WebSocket('wss://chat.example.com');
socket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  IMCAT.emit(`chat:${data.type}`, data.payload);
};

// 인스턴스 등록
[chat, onlineStatus].forEach(inst => {
  IMCAT.view.registerInstance(inst);
});
```

---

### 예제 5: 데이터 분석 대시보드

**사용 모듈:** DataTable + Gantt + Calendar + SplitPane

```javascript
const [DataViz, AdvancedUI] = await Promise.all([
  IMCAT.use('data-viz'),
  IMCAT.use('advanced-ui')
]);

// 분할 패널 레이아웃
const splitPane = new AdvancedUI.SplitPane('#dashboard', {
  direction: 'horizontal',
  initialSizes: [30, 70],
  minSizes: [200, 400]
});

// 왼쪽: 프로젝트 목록
const projectTable = new DataViz.DataTable('#projectList', {
  data: projects,
  columns: [
    { key: 'name', title: '프로젝트' },
    { key: 'status', title: '상태', render: (v) => `<span class="badge badge--${v}">${v}</span>` }
  ],
  onRowClick: (project) => {
    loadProjectDetail(project.id);
  }
});

// 오른쪽: 간트 차트
const gantt = new DataViz.Gantt('#ganttChart', {
  tasks: [],
  viewMode: 'week',
  onTaskClick: (task) => {
    showTaskDetail(task);
  },
  onDateChange: (task, start, end) => {
    updateTask(task.id, { start, end });
  }
});

// 캘린더 (마일스톤)
const calendar = new DataViz.Calendar('#milestoneCalendar', {
  events: [],
  onEventClick: (event) => {
    showMilestoneDetail(event);
  }
});

// 프로젝트 상세 로드
async function loadProjectDetail(projectId) {
  IMCAT.loading.show();
  try {
    const [tasks, milestones] = await Promise.all([
      IMCAT.api.get(`/api/projects/${projectId}/tasks`),
      IMCAT.api.get(`/api/projects/${projectId}/milestones`)
    ]);
    
    gantt.setTasks(tasks);
    calendar.setEvents(milestones.map(m => ({
      id: m.id,
      title: m.name,
      date: m.dueDate,
      color: m.completed ? 'green' : 'blue'
    })));
  } finally {
    IMCAT.loading.hide();
  }
}

// 인스턴스 등록
[splitPane, projectTable, gantt, calendar].forEach(inst => {
  IMCAT.view.registerInstance(inst);
});
```

---

## 모듈 로드 최적화

### 병렬 로드 (권장)

```javascript
// ✅ 좋음: Promise.all로 병렬 로드
const [Module1, Module2, Module3] = await Promise.all([
  IMCAT.use('module1'),
  IMCAT.use('module2'),
  IMCAT.use('module3')
]);
```

### 프리로드

```javascript
// 페이지 로드 시 미리 로드
IMCAT.loader.preload(['overlays', 'feedback', 'data-viz']);

// 나중에 사용할 때 즉시 사용 가능
const Overlays = await IMCAT.use('overlays');  // 캐시에서 즉시 반환
```

### 조건부 로드

```javascript
// 필요할 때만 로드
document.getElementById('openEditor').onclick = async () => {
  const TextEditors = await IMCAT.use('text-editors');
  const editor = new TextEditors.RichTextEditor('#editor');
  IMCAT.view.registerInstance(editor);
};
```

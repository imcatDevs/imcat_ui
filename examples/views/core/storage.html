<!-- Breadcrumb -->
<div class="page-title-box">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#home">Home</a></li>
      <li class="breadcrumb-item"><a href="#core">Core</a></li>
      <li class="breadcrumb-item active">Storage</li>
    </ol>
  </nav>
  <h1 class="page-title">Storage</h1>
  <p class="page-description">localStorage/sessionStorage ë˜í¼ - ìë™ ì§ë ¬í™”, TTL(ë§Œë£Œ ì‹œê°„) ì§€ì›</p>
</div>

<div class="row">
  <!-- ê¸°ë³¸ ì €ì¥/ì¡°íšŒ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ’¾ ê¸°ë³¸ ì €ì¥/ì¡°íšŒ</h2>
        <p class="card__description">set/getìœ¼ë¡œ ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ì €ì¥í•  ë°ì´í„°</h4>
          <input type="text" id="storage_key" class="form-control" placeholder="í‚¤" value="username" style="margin-bottom: 0.5rem;">
          <input type="text" id="storage_value" class="form-control" placeholder="ê°’" value="í™ê¸¸ë™" style="margin-bottom: 0.5rem;">
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn--primary btn--sm" onclick="saveData()">ì €ì¥</button>
            <button class="btn btn--secondary btn--sm" onclick="loadData()">ì¡°íšŒ</button>
            <button class="btn btn--danger btn--sm" onclick="removeData()">ì‚­ì œ</button>
          </div>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="storage_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ê°ì²´ ì €ì¥ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ“¦ ê°ì²´ ì €ì¥ (ìë™ ì§ë ¬í™”)</h2>
        <p class="card__description">ê°ì²´/ë°°ì—´ì€ ìë™ìœ¼ë¡œ JSON ì§ë ¬í™”ë¨</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ì‚¬ìš©ì ì •ë³´ ì €ì¥</h4>
          <input type="text" id="user_name" class="form-control" placeholder="ì´ë¦„" value="ê¹€ì² ìˆ˜" style="margin-bottom: 0.5rem;">
          <input type="email" id="user_email" class="form-control" placeholder="ì´ë©”ì¼" value="kim@example.com" style="margin-bottom: 0.5rem;">
          <input type="number" id="user_age" class="form-control" placeholder="ë‚˜ì´" value="30" style="margin-bottom: 0.5rem;">
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn--primary btn--sm" onclick="saveUser()">ì‚¬ìš©ì ì €ì¥</button>
            <button class="btn btn--secondary btn--sm" onclick="loadUser()">ì‚¬ìš©ì ì¡°íšŒ</button>
          </div>
          
          <h4 style="margin-top: 1rem;">ì €ì¥ëœ ì‚¬ìš©ì</h4>
          <div id="user_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- TTL (ë§Œë£Œ ì‹œê°„) -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">â±ï¸ TTL (ë§Œë£Œ ì‹œê°„)</h2>
        <p class="card__description">expires ì˜µì…˜ìœ¼ë¡œ ìë™ ë§Œë£Œ ì„¤ì •</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ë§Œë£Œ ì‹œê°„ ì„¤ì •</h4>
          <input type="text" id="ttl_value" class="form-control" placeholder="ì €ì¥í•  ê°’" value="ì„ì‹œ í† í°" style="margin-bottom: 0.5rem;">
          <select id="ttl_seconds" class="form-control" style="margin-bottom: 0.5rem;">
            <option value="5">5ì´ˆ í›„ ë§Œë£Œ</option>
            <option value="10">10ì´ˆ í›„ ë§Œë£Œ</option>
            <option value="30">30ì´ˆ í›„ ë§Œë£Œ</option>
            <option value="60">1ë¶„ í›„ ë§Œë£Œ</option>
          </select>
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn--primary btn--sm" onclick="saveTTL()">TTLë¡œ ì €ì¥</button>
            <button class="btn btn--secondary btn--sm" onclick="loadTTL()">ì¡°íšŒ</button>
          </div>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="ttl_result" class="result-box"></div>
          <small id="ttl_countdown" style="color: var(--text-secondary);"></small>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Session Storage -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ”’ Session Storage</h2>
        <p class="card__description">ë¸Œë¼ìš°ì € íƒ­ ë‹«ìœ¼ë©´ ìë™ ì‚­ì œ</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ì„¸ì…˜ ë°ì´í„°</h4>
          <input type="text" id="session_key" class="form-control" placeholder="í‚¤" value="sessionData" style="margin-bottom: 0.5rem;">
          <input type="text" id="session_value" class="form-control" placeholder="ê°’" value="íƒ­ì„ ë‹«ìœ¼ë©´ ì‚¬ë¼ì§‘ë‹ˆë‹¤" style="margin-bottom: 0.5rem;">
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn--primary btn--sm" onclick="saveSession()">ì„¸ì…˜ì— ì €ì¥</button>
            <button class="btn btn--secondary btn--sm" onclick="loadSession()">ì¡°íšŒ</button>
          </div>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="session_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì „ì²´ ìŠ¤í† ë¦¬ì§€ ì¡°íšŒ -->
  <div class="col-12">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ“‹ í˜„ì¬ ì €ì¥ëœ ë°ì´í„°</h2>
        <div style="display: flex; gap: 0.5rem;">
          <button class="btn btn--secondary btn--sm" onclick="showAllStorage()">ìƒˆë¡œê³ ì¹¨</button>
          <button class="btn btn--danger btn--sm" onclick="clearAllStorage()">ì „ì²´ ì‚­ì œ</button>
        </div>
      </div>
      <div class="card__body">
        <div id="all_storage" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
          <div>
            <h4 style="margin-bottom: 0.5rem;">localStorage</h4>
            <div id="local_storage_list" class="storage-list"></div>
          </div>
          <div>
            <h4 style="margin-bottom: 0.5rem;">sessionStorage</h4>
            <div id="session_storage_list" class="storage-list"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ì‚¬ìš©ë²• -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">ğŸ“– API ë ˆí¼ëŸ°ìŠ¤</h2>
      </div>
      <div class="card__body">
        <pre><code>// ê¸°ë³¸ ì €ì¥/ì¡°íšŒ
IMCAT.storage.set('key', 'value');
IMCAT.storage.get('key'); // 'value'
IMCAT.storage.get('ì—†ëŠ”í‚¤', 'ê¸°ë³¸ê°’'); // 'ê¸°ë³¸ê°’'

// ê°ì²´ ì €ì¥ (ìë™ ì§ë ¬í™”)
IMCAT.storage.set('user', { name: 'í™ê¸¸ë™', age: 25 });
IMCAT.storage.get('user'); // { name: 'í™ê¸¸ë™', age: 25 }

// TTL (ë§Œë£Œ ì‹œê°„)
IMCAT.storage.set('token', 'abc123', { expires: 3600 }); // 1ì‹œê°„ í›„ ë§Œë£Œ

// Session Storage
IMCAT.storage.set('temp', 'data', { storage: 'session' });
IMCAT.storage.get('temp', null, 'session');

// ì‚­ì œ
IMCAT.storage.remove('key');
IMCAT.storage.clear(); // ì „ì²´ ì‚­ì œ

// ì¡´ì¬ ì—¬ë¶€ í™•ì¸
IMCAT.storage.has('key'); // true/false</code></pre>
      </div>
    </div>
  </div>
</div>

<style>
  .demo-section h4 {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
  }
  
  .result-box {
    padding: 1rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    font-family: monospace;
    font-size: 0.875rem;
    word-break: break-all;
    min-height: 2.5rem;
  }
  
  .form-control {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 0.875rem;
    background: var(--bg-primary);
    color: var(--text-primary);
  }
  
  .storage-list {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 0.75rem;
    min-height: 100px;
    max-height: 200px;
    overflow-y: auto;
  }
  
  .storage-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem;
    background: var(--bg-primary);
    border-radius: 4px;
    margin-bottom: 0.5rem;
    font-size: 0.8125rem;
  }
  
  .storage-item:last-child {
    margin-bottom: 0;
  }
  
  .storage-item__key {
    font-weight: 600;
    color: var(--primary-color);
  }
  
  .storage-item__value {
    color: var(--text-secondary);
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
</style>

<script>
  // ê¸°ë³¸ ì €ì¥/ì¡°íšŒ
  function saveData() {
    const key = document.getElementById('storage_key').value;
    const value = document.getElementById('storage_value').value;
    IMCAT.storage.set(key, value);
    document.getElementById('storage_result').textContent = `âœ… "${key}" ì €ì¥ ì™„ë£Œ`;
    showAllStorage();
  }
  
  function loadData() {
    const key = document.getElementById('storage_key').value;
    const value = IMCAT.storage.get(key, '(ì—†ìŒ)');
    document.getElementById('storage_result').textContent = `ğŸ“¥ ${key} = "${value}"`;
  }
  
  function removeData() {
    const key = document.getElementById('storage_key').value;
    IMCAT.storage.remove(key);
    document.getElementById('storage_result').textContent = `ğŸ—‘ï¸ "${key}" ì‚­ì œë¨`;
    showAllStorage();
  }
  
  // ê°ì²´ ì €ì¥
  function saveUser() {
    const user = {
      name: document.getElementById('user_name').value,
      email: document.getElementById('user_email').value,
      age: parseInt(document.getElementById('user_age').value)
    };
    IMCAT.storage.set('currentUser', user);
    document.getElementById('user_result').textContent = 'âœ… ì‚¬ìš©ì ì €ì¥ ì™„ë£Œ';
    showAllStorage();
  }
  
  function loadUser() {
    const user = IMCAT.storage.get('currentUser');
    if (user) {
      document.getElementById('user_result').innerHTML = `
        <strong>ì´ë¦„:</strong> ${user.name}<br>
        <strong>ì´ë©”ì¼:</strong> ${user.email}<br>
        <strong>ë‚˜ì´:</strong> ${user.age}
      `;
    } else {
      document.getElementById('user_result').textContent = 'ì €ì¥ëœ ì‚¬ìš©ì ì—†ìŒ';
    }
  }
  
  // TTL
  let ttlTimer = null;
  
  function saveTTL() {
    const value = document.getElementById('ttl_value').value;
    const seconds = parseInt(document.getElementById('ttl_seconds').value);
    
    IMCAT.storage.set('ttlData', value, { expires: seconds });
    document.getElementById('ttl_result').textContent = `âœ… "${value}" ì €ì¥ (${seconds}ì´ˆ í›„ ë§Œë£Œ)`;
    
    // ì¹´ìš´íŠ¸ë‹¤ìš´
    if (ttlTimer) clearInterval(ttlTimer);
    let remaining = seconds;
    const countdown = document.getElementById('ttl_countdown');
    countdown.textContent = `â³ ${remaining}ì´ˆ ë‚¨ìŒ`;
    
    ttlTimer = setInterval(() => {
      remaining--;
      if (remaining > 0) {
        countdown.textContent = `â³ ${remaining}ì´ˆ ë‚¨ìŒ`;
      } else {
        countdown.textContent = 'âŒ› ë§Œë£Œë¨!';
        clearInterval(ttlTimer);
      }
    }, 1000);
    
    showAllStorage();
  }
  
  function loadTTL() {
    const value = IMCAT.storage.get('ttlData', '(ë§Œë£Œë¨ ë˜ëŠ” ì—†ìŒ)');
    document.getElementById('ttl_result').textContent = `ğŸ“¥ ê°’: "${value}"`;
  }
  
  // Session Storage
  function saveSession() {
    const key = document.getElementById('session_key').value;
    const value = document.getElementById('session_value').value;
    IMCAT.storage.set(key, value, { storage: 'session' });
    document.getElementById('session_result').textContent = `âœ… ì„¸ì…˜ì— "${key}" ì €ì¥ ì™„ë£Œ`;
    showAllStorage();
  }
  
  function loadSession() {
    const key = document.getElementById('session_key').value;
    const value = IMCAT.storage.get(key, '(ì—†ìŒ)', 'session');
    document.getElementById('session_result').textContent = `ğŸ“¥ ${key} = "${value}"`;
  }
  
  // ì „ì²´ ìŠ¤í† ë¦¬ì§€ í‘œì‹œ
  function showAllStorage() {
    // localStorage
    let localHTML = '';
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      const value = localStorage.getItem(key);
      localHTML += `
        <div class="storage-item">
          <span class="storage-item__key">${key}</span>
          <span class="storage-item__value">${value.substring(0, 30)}${value.length > 30 ? '...' : ''}</span>
        </div>
      `;
    }
    document.getElementById('local_storage_list').innerHTML = localHTML || '<div style="color: var(--text-secondary);">ë¹„ì–´ìˆìŒ</div>';
    
    // sessionStorage
    let sessionHTML = '';
    for (let i = 0; i < sessionStorage.length; i++) {
      const key = sessionStorage.key(i);
      const value = sessionStorage.getItem(key);
      sessionHTML += `
        <div class="storage-item">
          <span class="storage-item__key">${key}</span>
          <span class="storage-item__value">${value.substring(0, 30)}${value.length > 30 ? '...' : ''}</span>
        </div>
      `;
    }
    document.getElementById('session_storage_list').innerHTML = sessionHTML || '<div style="color: var(--text-secondary);">ë¹„ì–´ìˆìŒ</div>';
  }
  
  function clearAllStorage() {
    if (confirm('ëª¨ë“  ìŠ¤í† ë¦¬ì§€ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      localStorage.clear();
      sessionStorage.clear();
      showAllStorage();
    }
  }
  
  // ì´ˆê¸° ì‹¤í–‰
  showAllStorage();
</script>

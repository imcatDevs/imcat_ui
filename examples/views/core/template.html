<!-- Breadcrumb -->
<div class="page-title-box">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#home">Home</a></li>
      <li class="breadcrumb-item"><a href="#core">Core</a></li>
      <li class="breadcrumb-item active">Template Engine</li>
    </ol>
  </nav>
  <h1 class="page-title">Template Engine</h1>
  <p class="page-description">ì½”ì–´ ë‚´ì¥ í…œí”Œë¦¿ ì—”ì§„ - {{key}} ë¬¸ë²•, XSS ë°©ì–´, ì¡°ê±´ë¶€/ë¦¬ìŠ¤íŠ¸ ë Œë”ë§</p>
</div>

<div class="row">
  <!-- ê¸°ë³¸ ë Œë”ë§ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ“ ê¸°ë³¸ ë Œë”ë§ (render)</h2>
        <p class="card__description">{{key}} ë¬¸ë²•ìœ¼ë¡œ ë°ì´í„° ë°”ì¸ë”© (ìë™ XSS ë°©ì–´)</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>í…œí”Œë¦¿</h4>
          <pre><code id="basic_template">Hello {{name}}! ë‚˜ì´: {{age}}ì„¸</code></pre>
          
          <h4 style="margin-top: 1rem;">ë°ì´í„°</h4>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 1rem;">
            <input type="text" id="basic_name" class="form-control" placeholder="ì´ë¦„" value="í™ê¸¸ë™">
            <input type="number" id="basic_age" class="form-control" placeholder="ë‚˜ì´" value="25">
          </div>
          <button class="btn btn--primary btn--sm" onclick="renderBasic()">ë Œë”ë§</button>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="basic_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- XSS ë°©ì–´ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ›¡ï¸ XSS ë°©ì–´</h2>
        <p class="card__description">ì‚¬ìš©ì ì…ë ¥ì€ ìë™ìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„ë¨</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ìœ„í—˜í•œ ì…ë ¥ í…ŒìŠ¤íŠ¸</h4>
          <input type="text" id="xss_input" class="form-control" value="<script>alert('XSS')</script>" style="margin-bottom: 1rem;">
          <button class="btn btn--primary btn--sm" onclick="renderXSS()">ë Œë”ë§</button>
          
          <h4 style="margin-top: 1rem;">render() ê²°ê³¼ (ì•ˆì „)</h4>
          <div id="xss_safe" class="result-box result-box--success"></div>
          
          <h4 style="margin-top: 1rem;">renderRaw() ê²°ê³¼ (ìœ„í—˜)</h4>
          <div id="xss_raw" class="result-box result-box--danger"></div>
          <small style="color: var(--text-secondary);">âš ï¸ renderRaw()ëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” HTMLë§Œ ì‚¬ìš©</small>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì¡°ê±´ë¶€ ë Œë”ë§ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ”€ ì¡°ê±´ë¶€ ë Œë”ë§ (if)</h2>
        <p class="card__description">ì¡°ê±´ì— ë”°ë¼ í…œí”Œë¦¿ í‘œì‹œ/ìˆ¨ê¹€</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ì¡°ê±´</h4>
          <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
              <input type="checkbox" id="cond_admin" checked> ê´€ë¦¬ì
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
              <input type="checkbox" id="cond_premium"> í”„ë¦¬ë¯¸ì—„ íšŒì›
            </label>
          </div>
          <button class="btn btn--primary btn--sm" onclick="renderConditional()">ë Œë”ë§</button>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="cond_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ“‹ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ (each)</h2>
        <p class="card__description">ë°°ì—´ ë°ì´í„°ë¥¼ ë°˜ë³µ ë Œë”ë§</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ë°ì´í„° (JSON)</h4>
          <textarea id="list_data" class="form-control" rows="4" style="font-family: monospace; font-size: 0.8125rem;">[
  { "name": "í™ê¸¸ë™", "role": "ê°œë°œì" },
  { "name": "ê¹€ì² ìˆ˜", "role": "ë””ìì´ë„ˆ" },
  { "name": "ì´ì˜í¬", "role": "ê¸°íšì" }
]</textarea>
          <button class="btn btn--primary btn--sm" onclick="renderList()" style="margin-top: 0.5rem;">ë Œë”ë§</button>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <ul id="list_result" class="result-list"></ul>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì»´íŒŒì¼ (ì¬ì‚¬ìš©) -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">âš¡ ì»´íŒŒì¼ (compile)</h2>
        <p class="card__description">í…œí”Œë¦¿ì„ ë¯¸ë¦¬ ì»´íŒŒì¼í•˜ì—¬ ì¬ì‚¬ìš©</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <h4>ì»´íŒŒì¼ëœ í…œí”Œë¦¿</h4>
          <pre><code>const greeting = IMCAT.template.compile('ì•ˆë…•í•˜ì„¸ìš”, {{name}}ë‹˜!');</code></pre>
          
          <h4 style="margin-top: 1rem;">ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œ</h4>
          <div style="display: grid; gap: 0.5rem; margin-bottom: 1rem;">
            <input type="text" id="compile_name1" class="form-control" placeholder="ì´ë¦„ 1" value="í™ê¸¸ë™">
            <input type="text" id="compile_name2" class="form-control" placeholder="ì´ë¦„ 2" value="ê¹€ì² ìˆ˜">
            <input type="text" id="compile_name3" class="form-control" placeholder="ì´ë¦„ 3" value="ì´ì˜í¬">
          </div>
          <button class="btn btn--primary btn--sm" onclick="renderCompile()">ë Œë”ë§</button>
          
          <h4 style="margin-top: 1rem;">ê²°ê³¼</h4>
          <div id="compile_result" class="result-box"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì‹¤ì „ ì˜ˆì œ: ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->
  <div class="col-lg-6">
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">ğŸ¯ ì‹¤ì „ ì˜ˆì œ: ì‚¬ìš©ì ì¹´ë“œ</h2>
        <p class="card__description">í…œí”Œë¦¿ì„ í™œìš©í•œ ë™ì  UI ìƒì„±</p>
      </div>
      <div class="card__body">
        <div class="demo-section">
          <button class="btn btn--primary btn--sm" onclick="renderUserCards()">ì‚¬ìš©ì ì¹´ë“œ ìƒì„±</button>
          <button class="btn btn--secondary btn--sm" onclick="clearUserCards()">ì´ˆê¸°í™”</button>
          
          <div id="user_cards" style="margin-top: 1rem; display: grid; gap: 0.75rem;"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ì‚¬ìš©ë²• -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">ğŸ“– API ë ˆí¼ëŸ°ìŠ¤</h2>
      </div>
      <div class="card__body">
        <h3 style="margin-bottom: 1rem;">ê¸°ë³¸ ì‚¬ìš©ë²•</h3>
        <pre><code>// render() - ìë™ XSS ë°©ì–´
const html = IMCAT.template.render('Hello {{name}}!', { name: 'John' });
// ê²°ê³¼: 'Hello John!'

// renderRaw() - ì´ìŠ¤ì¼€ì´í”„ ì—†ìŒ (ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” HTMLë§Œ!)
const html = IMCAT.template.renderRaw('{{content}}', { content: '<b>Bold</b>' });
// ê²°ê³¼: '<b>Bold</b>'</code></pre>

        <h3 style="margin-top: 2rem; margin-bottom: 1rem;">ì¡°ê±´ë¶€ ë Œë”ë§</h3>
        <pre><code>// if(condition, template, data) - ì¡°ê±´ì´ trueì¼ ë•Œë§Œ ë Œë”ë§
const adminBtn = IMCAT.template.if(user.isAdmin, '&lt;button&gt;ê´€ë¦¬ì íŒ¨ë„&lt;/button&gt;', user);

// ë³µí•© ì¡°ê±´
const premium = IMCAT.template.if(user.isPremium && user.points > 1000, 
  'í™˜ì˜í•©ë‹ˆë‹¤, {{name}}ë‹˜! í¬ì¸íŠ¸: {{points}}', user);</code></pre>

        <h3 style="margin-top: 2rem; margin-bottom: 1rem;">ë¦¬ìŠ¤íŠ¸ ë Œë”ë§</h3>
        <pre><code>// each(items, template) - ë°°ì—´ ë°˜ë³µ ë Œë”ë§
const users = [
  { name: 'í™ê¸¸ë™', age: 30 },
  { name: 'ê¹€ì² ìˆ˜', age: 25 }
];

const html = IMCAT.template.each(users, '&lt;li&gt;{{name}} ({{age}}ì„¸)&lt;/li&gt;');
// ê²°ê³¼: '&lt;li&gt;í™ê¸¸ë™ (30ì„¸)&lt;/li&gt;&lt;li&gt;ê¹€ì² ìˆ˜ (25ì„¸)&lt;/li&gt;'</code></pre>

        <h3 style="margin-top: 2rem; margin-bottom: 1rem;">í…œí”Œë¦¿ ì»´íŒŒì¼</h3>
        <pre><code>// compile(template) - ì¬ì‚¬ìš©ì„ ìœ„í•œ í•¨ìˆ˜ ìƒì„±
const greeting = IMCAT.template.compile('ì•ˆë…•í•˜ì„¸ìš”, {{name}}ë‹˜!');

greeting({ name: 'í™ê¸¸ë™' }); // 'ì•ˆë…•í•˜ì„¸ìš”, í™ê¸¸ë™ë‹˜!'
greeting({ name: 'ê¹€ì² ìˆ˜' }); // 'ì•ˆë…•í•˜ì„¸ìš”, ê¹€ì² ìˆ˜ë‹˜!'
greeting({ name: 'ì´ì˜í¬' }); // 'ì•ˆë…•í•˜ì„¸ìš”, ì´ì˜í¬ë‹˜!'</code></pre>
      </div>
    </div>
  </div>
</div>

<style>
  .demo-section h4 {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
  }
  
  .result-box {
    padding: 1rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    font-family: monospace;
    font-size: 0.875rem;
    word-break: break-all;
    min-height: 2.5rem;
  }
  
  .result-box--success {
    background: #dcfce7;
    border: 1px solid #86efac;
  }
  
  .result-box--danger {
    background: #fee2e2;
    border: 1px solid #fca5a5;
  }
  
  .result-list {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  
  .result-list li {
    padding: 0.5rem 0.75rem;
    background: var(--bg-secondary);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
  }
  
  .result-list li:last-child {
    margin-bottom: 0;
  }
  
  .user-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem 1rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    border-left: 4px solid var(--primary-color);
  }
  
  .user-card__avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary-color);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
  }
  
  .user-card__info {
    flex: 1;
  }
  
  .user-card__name {
    font-weight: 600;
    font-size: 0.9375rem;
  }
  
  .user-card__role {
    font-size: 0.8125rem;
    color: var(--text-secondary);
  }
  
  .user-card__badge {
    padding: 0.25rem 0.5rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
  }
  
  .user-card__badge--active {
    background: #dcfce7;
    color: #166534;
  }
  
  .user-card__badge--inactive {
    background: #fee2e2;
    color: #991b1b;
  }
  
  .form-control {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 0.875rem;
    background: var(--bg-primary);
    color: var(--text-primary);
  }
  
  .form-control:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  pre {
    background: var(--bg-secondary);
    padding: 1rem;
    border-radius: 8px;
    overflow-x: auto;
    font-size: 0.8125rem;
  }
  
  code {
    font-family: 'Consolas', 'Monaco', monospace;
  }
</style>

<!-- JavaScript -->
<script>
  // ê¸°ë³¸ ë Œë”ë§
  function renderBasic() {
    const template = 'Hello {{name}}! ë‚˜ì´: {{age}}ì„¸';
    const data = {
      name: document.getElementById('basic_name').value,
      age: document.getElementById('basic_age').value
    };
    const result = IMCAT.template.render(template, data);
    document.getElementById('basic_result').textContent = result;
  }
  
  // XSS ë°©ì–´ í…ŒìŠ¤íŠ¸
  function renderXSS() {
    const input = document.getElementById('xss_input').value;
    const template = 'ì‚¬ìš©ì ì…ë ¥: {{input}}';
    
    // ì•ˆì „í•œ ë Œë”ë§ (ìë™ ì´ìŠ¤ì¼€ì´í”„)
    const safeResult = IMCAT.template.render(template, { input });
    document.getElementById('xss_safe').textContent = safeResult;
    
    // ìœ„í—˜í•œ ë Œë”ë§ (ì´ìŠ¤ì¼€ì´í”„ ì—†ìŒ)
    const rawResult = IMCAT.template.renderRaw(template, { input });
    document.getElementById('xss_raw').textContent = rawResult;
  }
  
  // ì¡°ê±´ë¶€ ë Œë”ë§
  function renderConditional() {
    const isAdmin = document.getElementById('cond_admin').checked;
    const isPremium = document.getElementById('cond_premium').checked;
    
    let result = '';
    result += IMCAT.template.if(isAdmin, '<div style="color: #dc2626;">ğŸ” ê´€ë¦¬ì ê¶Œí•œ í™œì„±í™”</div>');
    result += IMCAT.template.if(isPremium, '<div style="color: #2563eb;">â­ í”„ë¦¬ë¯¸ì—„ íšŒì› í˜œíƒ</div>');
    result += IMCAT.template.if(!isAdmin && !isPremium, '<div style="color: var(--text-secondary);">ì¼ë°˜ íšŒì›</div>');
    
    document.getElementById('cond_result').innerHTML = result || 'ì¡°ê±´ì„ ì„ íƒí•˜ì„¸ìš”';
  }
  
  // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
  function renderList() {
    try {
      const data = JSON.parse(document.getElementById('list_data').value);
      const html = IMCAT.template.each(data, '<li><strong>{{name}}</strong> - {{role}}</li>');
      document.getElementById('list_result').innerHTML = html || '<li>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</li>';
    } catch (e) {
      document.getElementById('list_result').innerHTML = '<li style="color: #dc2626;">JSON íŒŒì‹± ì˜¤ë¥˜: ' + e.message + '</li>';
    }
  }
  
  // ì»´íŒŒì¼ ë Œë”ë§
  function renderCompile() {
    const greeting = IMCAT.template.compile('ì•ˆë…•í•˜ì„¸ìš”, {{name}}ë‹˜!');
    
    const names = [
      document.getElementById('compile_name1').value,
      document.getElementById('compile_name2').value,
      document.getElementById('compile_name3').value
    ];
    
    const results = names.map(name => greeting({ name })).join('<br>');
    document.getElementById('compile_result').innerHTML = results;
  }
  
  // ì‚¬ìš©ì ì¹´ë“œ ë Œë”ë§
  function renderUserCards() {
    const users = [
      { name: 'í™ê¸¸ë™', initial: 'í™', role: 'ì‹œë‹ˆì–´ ê°œë°œì', status: 'active', statusText: 'í™œì„±' },
      { name: 'ê¹€ì² ìˆ˜', initial: 'ê¹€', role: 'UX ë””ìì´ë„ˆ', status: 'active', statusText: 'í™œì„±' },
      { name: 'ì´ì˜í¬', initial: 'ì´', role: 'í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €', status: 'inactive', statusText: 'ë¹„í™œì„±' },
      { name: 'ë°•ì§€ë¯¼', initial: 'ë°•', role: 'ì£¼ë‹ˆì–´ ê°œë°œì', status: 'active', statusText: 'í™œì„±' }
    ];
    
    const cardTemplate = `
      <div class="user-card">
        <div class="user-card__avatar">{{initial}}</div>
        <div class="user-card__info">
          <div class="user-card__name">{{name}}</div>
          <div class="user-card__role">{{role}}</div>
        </div>
        <span class="user-card__badge user-card__badge--{{status}}">{{statusText}}</span>
      </div>
    `;
    
    const html = IMCAT.template.each(users, cardTemplate);
    document.getElementById('user_cards').innerHTML = html;
  }
  
  function clearUserCards() {
    document.getElementById('user_cards').innerHTML = '';
  }
  
  // ì´ˆê¸° ì‹¤í–‰
  renderBasic();
  renderXSS();
  renderConditional();
  renderList();
  renderCompile();
</script>

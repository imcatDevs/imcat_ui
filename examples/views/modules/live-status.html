<!-- Breadcrumb -->
<div class="page-title-box">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#" catui-href="views/home.html">Home</a></li>
      <li class="breadcrumb-item"><a href="#" catui-href="views/modules.html">Modules</a></li>
      <li class="breadcrumb-item active" aria-current="page">Live Status</li>
    </ol>
  </nav>
  <h1 class="page-title">Live Status</h1>
  <p class="page-description">실시간 상태 표시 컴포넌트. 온라인 상태, 타이핑 인디케이터, 활동 상태 등을 표시합니다.</p>
</div>

<!-- Online Status -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Online Status</h2>
        <p class="card__description">사용자의 온라인/오프라인 상태를 표시합니다.</p>
      </div>
      <div class="card__body">
        <div class="d-flex flex-wrap gap-4 align-items-center mb-4">
          <!-- User Avatars with Status -->
          <div id="status_user1" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">JS</div>
          <div id="status_user2" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">MK</div>
          <div id="status_user3" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">YH</div>
          <div id="status_user4" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">SJ</div>
        </div>
        
        <div class="d-flex gap-2 flex-wrap">
          <button class="btn btn--outline-success btn--sm" onclick="changeStatus('online')">온라인</button>
          <button class="btn btn--outline-secondary btn--sm" onclick="changeStatus('offline')">오프라인</button>
          <button class="btn btn--outline-warning btn--sm" onclick="changeStatus('away')">자리비움</button>
          <button class="btn btn--outline-danger btn--sm" onclick="changeStatus('busy')">바쁨</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Status Badges -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Status Badges</h2>
        <p class="card__description">독립적으로 사용할 수 있는 상태 배지입니다.</p>
      </div>
      <div class="card__body">
        <div class="d-flex flex-wrap gap-3">
          <span class="status-badge status-badge--online">온라인</span>
          <span class="status-badge status-badge--offline">오프라인</span>
          <span class="status-badge status-badge--away">자리비움</span>
          <span class="status-badge status-badge--busy">바쁨</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Typing Indicator -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Typing Indicator</h2>
        <p class="card__description">상대방이 입력 중임을 표시합니다.</p>
      </div>
      <div class="card__body">
        <div id="typing_demo" class="mb-4"></div>
        
        <div class="d-flex gap-2 flex-wrap mb-3">
          <button class="btn btn--primary btn--sm" onclick="typingDemo.addUser('김철수')">김철수 추가</button>
          <button class="btn btn--primary btn--sm" onclick="typingDemo.addUser('이영희')">이영희 추가</button>
          <button class="btn btn--outline-secondary btn--sm" onclick="typingDemo.removeUser('김철수')">김철수 제거</button>
          <button class="btn btn--outline-danger btn--sm" onclick="typingDemo.clear()">모두 제거</button>
        </div>
        
        <div class="alert alert--info">
          <i class="material-icons-outlined">info</i>
          <span>채팅 애플리케이션에서 상대방이 메시지를 작성 중일 때 사용합니다.</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Activity Status -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Activity Status</h2>
        <p class="card__description">마지막 활동 시간을 표시합니다.</p>
      </div>
      <div class="card__body">
        <div class="d-flex flex-column gap-3 mb-4" style="max-width: 400px;">
          <div class="d-flex align-items-center gap-3 p-3 rounded" style="background: var(--bg-secondary);">
            <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">JS</div>
            <div>
              <div style="font-weight: 500;">김지수</div>
              <div id="activity1"></div>
            </div>
          </div>
          <div class="d-flex align-items-center gap-3 p-3 rounded" style="background: var(--bg-secondary);">
            <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">MH</div>
            <div>
              <div style="font-weight: 500;">박민혁</div>
              <div id="activity2"></div>
            </div>
          </div>
        </div>
        
        <button class="btn btn--primary btn--sm" onclick="activity1.updateNow(); activity2.updateNow();">활동 업데이트</button>
      </div>
    </div>
  </div>
</div>

<!-- Live Counter -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Live Counter</h2>
        <p class="card__description">실시간으로 변하는 숫자를 애니메이션과 함께 표시합니다.</p>
      </div>
      <div class="card__body">
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <div class="p-4 rounded text-center" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              <div style="font-size: 36px; font-weight: 700; color: white;">
                <span id="counter_visitors"></span>
              </div>
              <div style="color: rgba(255,255,255,0.8); font-size: 14px;">오늘 방문자</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="p-4 rounded text-center" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              <div style="font-size: 36px; font-weight: 700; color: white;">
                <span id="counter_sales"></span>
              </div>
              <div style="color: rgba(255,255,255,0.8); font-size: 14px;">총 매출</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="p-4 rounded text-center" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
              <div style="font-size: 36px; font-weight: 700; color: white;">
                <span id="counter_users"></span>
              </div>
              <div style="color: rgba(255,255,255,0.8); font-size: 14px;">접속 중인 사용자</div>
            </div>
          </div>
        </div>
        
        <div class="d-flex gap-2 flex-wrap">
          <button class="btn btn--primary btn--sm" onclick="incrementCounters()">카운터 증가</button>
          <button class="btn btn--outline-secondary btn--sm" onclick="decrementCounters()">카운터 감소</button>
          <button class="btn btn--outline-danger btn--sm" onclick="resetCounters()">초기화</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Live Viewers -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Live Viewers</h2>
        <p class="card__description">실시간 시청자 수 표시입니다.</p>
      </div>
      <div class="card__body">
        <div class="d-flex flex-wrap gap-4 align-items-center">
          <div class="live-viewers">
            <span class="live-viewers__dot"></span>
            <span>LIVE</span>
            <span class="live-viewers__count" id="live_count">1,234</span>
            <span>명 시청 중</span>
          </div>
          
          <button class="btn btn--outline-primary btn--sm" onclick="updateLiveCount()">시청자 업데이트</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Connection Status -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Connection Status</h2>
        <p class="card__description">네트워크 연결 상태를 모니터링합니다.</p>
      </div>
      <div class="card__body">
        <p>현재 연결 상태: <strong id="connection_state">연결됨</strong></p>
        
        <div class="alert alert--info mb-4">
          <i class="material-icons-outlined">info</i>
          <span>브라우저의 개발자 도구에서 네트워크를 "오프라인"으로 설정하면 상단에 알림이 표시됩니다.</span>
        </div>
        
        <div class="d-flex gap-2 flex-wrap">
          <button class="btn btn--outline-danger btn--sm" onclick="simulateOffline()">오프라인 시뮬레이션</button>
          <button class="btn btn--outline-success btn--sm" onclick="simulateOnline()">온라인 시뮬레이션</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Presence List -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">Presence List</h2>
        <p class="card__description">온라인 사용자 목록을 표시합니다.</p>
      </div>
      <div class="card__body">
        <div class="presence-list" style="max-width: 400px;">
          <div class="presence-item">
            <div class="presence-item__avatar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              JS
              <span class="online-status online-status--sm online-status--bottom-right" data-status="online"></span>
            </div>
            <div class="presence-item__info">
              <div class="presence-item__name">김지수</div>
              <div class="presence-item__status">문서 편집 중</div>
            </div>
          </div>
          <div class="presence-item">
            <div class="presence-item__avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              MH
              <span class="online-status online-status--sm online-status--bottom-right" data-status="away"></span>
            </div>
            <div class="presence-item__info">
              <div class="presence-item__name">박민혁</div>
              <div class="presence-item__status">5분 전 마지막 활동</div>
            </div>
          </div>
          <div class="presence-item">
            <div class="presence-item__avatar" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
              YH
              <span class="online-status online-status--sm online-status--bottom-right" data-status="busy"></span>
            </div>
            <div class="presence-item__info">
              <div class="presence-item__name">이영희</div>
              <div class="presence-item__status">회의 중</div>
            </div>
          </div>
          <div class="presence-item">
            <div class="presence-item__avatar" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
              SJ
              <span class="online-status online-status--sm online-status--bottom-right" data-status="offline"></span>
            </div>
            <div class="presence-item__info">
              <div class="presence-item__name">최성준</div>
              <div class="presence-item__status">오프라인</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Code Example -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">사용법</h2>
      </div>
      <div class="card__body">
        <pre><code class="language-javascript">// 모듈 로드
const LiveStatus = await IMCAT.use('live-status');

// Online Status - 온라인/오프라인 상태
const status = new LiveStatus.OnlineStatus('#avatar', {
  status: 'online',      // 'online' | 'offline' | 'away' | 'busy' | 'dnd'
  size: 'md',            // 'sm' | 'md' | 'lg'
  position: 'bottom-right',
  pulse: true,           // 온라인 시 펄스 애니메이션
  onChange: (status) => console.log('Status:', status)
});
status.setStatus('away');

// Typing Indicator - 타이핑 표시
const typing = new LiveStatus.TypingIndicator('#container', {
  users: ['김철수'],
  maxDisplay: 3,
  showNames: true,
  hideAfter: 3000        // 3초 후 자동 숨김
});
typing.addUser('이영희');
typing.removeUser('김철수');

// Activity Status - 활동 상태
const activity = new LiveStatus.ActivityStatus('#element', {
  lastActivity: new Date(),
  updateInterval: 60000,  // 1분마다 업데이트
  format: 'relative',     // 'relative' | 'absolute'
  prefix: '마지막 활동: '
});
activity.updateNow();

// Live Counter - 실시간 카운터
const counter = new LiveStatus.LiveCounter('#counter', {
  value: 1234,
  prefix: '',
  suffix: '명',
  separator: ',',
  decimals: 0,
  duration: 1000         // 애니메이션 시간
});
counter.setValue(5678);   // 애니메이션 적용
counter.increment(100);   // 100 증가
counter.decrement(50);    // 50 감소

// Connection Status - 연결 상태 모니터링
const connection = new LiveStatus.ConnectionStatus({
  showOnline: false,      // 온라인 복귀 시 표시 여부
  position: 'top',        // 'top' | 'bottom'
  autoHide: true,
  autoHideDelay: 3000,
  onlineMessage: '인터넷에 연결되었습니다',
  offlineMessage: '인터넷 연결이 끊겼습니다',
  onStatusChange: (isOnline) => console.log('Online:', isOnline)
});

// 메모리 관리
IMCAT.view.registerInstance(status);
IMCAT.view.registerInstance(typing);
IMCAT.view.registerInstance(activity);
IMCAT.view.registerInstance(counter);
IMCAT.view.registerInstance(connection);</code></pre>
      </div>
    </div>
  </div>
</div>

<script type="module">
// 모듈 로드
window.LiveStatusModule = await IMCAT.use('live-status');
const { OnlineStatus, TypingIndicator, ActivityStatus, LiveCounter, ConnectionStatus } = LiveStatusModule;

// Online Status 데모
window.statusInstances = [];
['status_user1', 'status_user2', 'status_user3', 'status_user4'].forEach((id, index) => {
  const statuses = ['online', 'away', 'busy', 'offline'];
  const status = new OnlineStatus(`#${id}`, {
    status: statuses[index],
    size: 'md',
    position: 'bottom-right',
    pulse: index === 0
  });
  statusInstances.push(status);
  IMCAT.view.registerInstance(status);
});

window.changeStatus = function(newStatus) {
  statusInstances.forEach(instance => {
    instance.setStatus(newStatus);
  });
};

// Typing Indicator 데모
window.typingDemo = new TypingIndicator('#typing_demo', {
  users: ['김철수'],
  showNames: true
});
IMCAT.view.registerInstance(typingDemo);

// Activity Status 데모
window.activity1 = new ActivityStatus('#activity1', {
  lastActivity: new Date(Date.now() - 5 * 60 * 1000), // 5분 전
  prefix: '마지막 활동: '
});
IMCAT.view.registerInstance(activity1);

window.activity2 = new ActivityStatus('#activity2', {
  lastActivity: new Date(Date.now() - 2 * 60 * 60 * 1000), // 2시간 전
  prefix: '마지막 활동: '
});
IMCAT.view.registerInstance(activity2);

// Live Counter 데모
window.counterVisitors = new LiveCounter('#counter_visitors', {
  value: 1234,
  separator: ','
});
IMCAT.view.registerInstance(counterVisitors);

window.counterSales = new LiveCounter('#counter_sales', {
  value: 89000000,
  prefix: '₩',
  separator: ','
});
IMCAT.view.registerInstance(counterSales);

window.counterUsers = new LiveCounter('#counter_users', {
  value: 42,
  separator: ','
});
IMCAT.view.registerInstance(counterUsers);

window.incrementCounters = function() {
  counterVisitors.increment(Math.floor(Math.random() * 100));
  counterSales.increment(Math.floor(Math.random() * 1000000));
  counterUsers.increment(Math.floor(Math.random() * 10));
};

window.decrementCounters = function() {
  counterVisitors.decrement(Math.floor(Math.random() * 50));
  counterSales.decrement(Math.floor(Math.random() * 500000));
  counterUsers.decrement(Math.floor(Math.random() * 5));
};

window.resetCounters = function() {
  counterVisitors.setValue(0, true);
  counterSales.setValue(0, true);
  counterUsers.setValue(0, true);
};

// Live viewers count
window.updateLiveCount = function() {
  const count = Math.floor(Math.random() * 5000) + 500;
  document.getElementById('live_count').textContent = count.toLocaleString();
};

// Connection Status 데모
window.connectionStatus = new ConnectionStatus({
  position: 'top',
  showOnline: true,
  autoHideDelay: 3000,
  onStatusChange: (isOnline) => {
    document.getElementById('connection_state').textContent = isOnline ? '연결됨' : '연결 끊김';
  }
});
IMCAT.view.registerInstance(connectionStatus);

// 오프라인/온라인 시뮬레이션
window.simulateOffline = function() {
  connectionStatus._showOffline();
  document.getElementById('connection_state').textContent = '연결 끊김';
};

window.simulateOnline = function() {
  connectionStatus._showOnline();
  document.getElementById('connection_state').textContent = '연결됨';
};
</script>

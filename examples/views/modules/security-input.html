<!-- Breadcrumb -->
<div class="page-title-box">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#home">Home</a></li>
      <li class="breadcrumb-item"><a href="#modules">Modules</a></li>
      <li class="breadcrumb-item active">Security Input</li>
    </ol>
  </nav>
  <h1 class="page-title">
    <i class="material-icons-outlined">pin</i>
    Security Input
  </h1>
  <p class="page-description">OTP 인증 코드 및 PIN 입력을 위한 보안 입력 컴포넌트</p>
</div>

<!-- OTP Input -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">
          <i class="material-icons-outlined">verified_user</i>
          OTP Input
        </h2>
        <p class="card__description">6자리 인증 코드 입력 (SMS, 이메일 인증)</p>
      </div>
      <div class="card__body">
        <div class="row">
          <!-- 기본 OTP -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">기본 OTP (6자리)</h5>
            <div id="otp_basic" class="mb-3"></div>
            <div id="otp_basic_result" class="text-muted"></div>
          </div>
          
          <!-- 구분선 있는 OTP -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">구분선 (3-3)</h5>
            <div id="otp_separator" class="mb-3"></div>
            <div id="otp_separator_result" class="text-muted"></div>
          </div>
          
          <!-- 4자리 OTP -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">4자리 인증</h5>
            <div id="otp_short" class="mb-3"></div>
            <div id="otp_short_result" class="text-muted"></div>
          </div>
          
          <!-- 마스킹 OTP -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">마스킹 모드</h5>
            <div id="otp_masked" class="mb-3"></div>
            <div id="otp_masked_result" class="text-muted"></div>
          </div>
        </div>
        
        <!-- 에러 상태 -->
        <div class="row mt-4">
          <div class="col-md-6">
            <h5 class="mb-3">에러 상태</h5>
            <div id="otp_error" class="mb-3"></div>
            <div class="d-flex gap-2 mt-3">
              <button class="btn btn--sm btn--danger" onclick="demo_otp_setError()">에러 설정</button>
              <button class="btn btn--sm btn--outline" onclick="demo_otp_clearError()">에러 해제</button>
            </div>
          </div>
          
          <div class="col-md-6">
            <h5 class="mb-3">비활성화</h5>
            <div id="otp_disabled"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- PIN Input -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">
          <i class="material-icons-outlined">lock</i>
          PIN Input
        </h2>
        <p class="card__description">보안 PIN 코드 입력 (결제, 잠금 해제)</p>
      </div>
      <div class="card__body">
        <div class="row">
          <!-- 기본 PIN -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">기본 PIN (4자리)</h5>
            <div id="pin_basic" class="mb-3"></div>
            <div id="pin_basic_result" class="text-muted"></div>
          </div>
          
          <!-- 6자리 PIN -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">6자리 PIN</h5>
            <div id="pin_long" class="mb-3"></div>
            <div id="pin_long_result" class="text-muted"></div>
          </div>
        </div>
        
        <!-- 가상 키패드 -->
        <div class="row mt-4">
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">가상 키패드</h5>
            <div id="pin_keypad" class="mb-3"></div>
            <div id="pin_keypad_result" class="text-muted"></div>
          </div>
          
          <!-- 셔플 키패드 -->
          <div class="col-md-6 mb-4">
            <h5 class="mb-3">셔플 키패드 (보안 강화)</h5>
            <div id="pin_shuffle" class="mb-3"></div>
            <button class="btn btn--sm btn--outline mt-2" onclick="demo_pin_reshuffle()">
              <i class="material-icons-outlined">shuffle</i>
              키패드 섞기
            </button>
            <div id="pin_shuffle_result" class="text-muted mt-2"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 실전 예제 -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">
          <i class="material-icons-outlined">app_registration</i>
          실전 예제
        </h2>
      </div>
      <div class="card__body">
        <div class="row">
          <!-- SMS 인증 -->
          <div class="col-md-6 mb-4">
            <div style="max-width: 400px; padding: 24px; background: var(--bg-secondary); border-radius: 16px;">
              <div style="text-align: center; margin-bottom: 20px;">
                <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #6366f1, #8b5cf6); border-radius: 16px; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;">
                  <i class="material-icons-outlined" style="font-size: 32px; color: #fff;">sms</i>
                </div>
                <h4 style="margin: 0 0 8px 0;">SMS 인증</h4>
                <p style="margin: 0; color: var(--text-secondary); font-size: 14px;">010-****-1234로 전송된 코드를 입력하세요</p>
              </div>
              <div id="demo_sms_otp" style="display: flex; justify-content: center;"></div>
              <div id="demo_sms_status" style="text-align: center; margin-top: 16px; font-size: 14px;"></div>
              <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn--sm btn--ghost" onclick="demo_resend_sms()">
                  <i class="material-icons-outlined">refresh</i>
                  인증번호 재전송
                </button>
              </div>
            </div>
          </div>
          
          <!-- 결제 비밀번호 -->
          <div class="col-md-6 mb-4">
            <div style="max-width: 350px; padding: 24px; background: var(--bg-secondary); border-radius: 16px;">
              <div style="text-align: center; margin-bottom: 20px;">
                <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 16px; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;">
                  <i class="material-icons-outlined" style="font-size: 32px; color: #fff;">payment</i>
                </div>
                <h4 style="margin: 0 0 8px 0;">결제 비밀번호</h4>
                <p style="margin: 0; color: var(--text-secondary); font-size: 14px;">6자리 비밀번호를 입력하세요</p>
              </div>
              <div id="demo_payment_pin"></div>
              <div id="demo_payment_status" style="text-align: center; margin-top: 16px; font-size: 14px;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 사용법 -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card__header">
        <h2 class="card__title">사용법</h2>
      </div>
      <div class="card__body">
        <pre style="background: var(--bg-secondary); padding: 16px; border-radius: 8px; overflow-x: auto;"><code>// 모듈 로드
const { OTPInput, PinInput } = await IMCAT.use('security-input');

// OTP Input
const otp = new OTPInput('#container', {
  length: 6,              // OTP 길이
  type: 'number',         // 'number' | 'text' | 'password'
  separator: true,        // 구분선 (3-3)
  mask: false,            // 입력 마스킹
  autoSubmit: true,       // 완료 시 자동 제출
  onComplete: (value) => {
    console.log('OTP:', value);
  }
});

// PIN Input
const pin = new PinInput('#container', {
  length: 4,              // PIN 길이
  mask: true,             // ●으로 표시
  showToggle: true,       // 보이기/숨기기 토글
  keypad: true,           // 가상 키패드
  shuffleKeypad: true,    // 키패드 셔플 (보안)
  onComplete: (value) => {
    console.log('PIN:', value);
  }
});

// API
otp.getValue();           // 값 가져오기
otp.setValue('123456');   // 값 설정
otp.clear();              // 초기화
otp.setError('메시지');   // 에러 표시
otp.clearError();         // 에러 해제
otp.destroy();            // 정리</code></pre>
      </div>
    </div>
  </div>
</div>

<script type="module">
const { OTPInput, PinInput } = await IMCAT.use('security-input');

// ====================
// OTP 예제
// ====================

// 기본 OTP
if (window._otp_basic && window._otp_basic.destroy) window._otp_basic.destroy();
window._otp_basic = new OTPInput('#otp_basic', {
  length: 6,
  onComplete: (value) => {
    document.getElementById('otp_basic_result').innerHTML = `<span style="color: var(--success-color);">✓ 입력 완료: ${value}</span>`;
  },
  onChange: (value) => {
    document.getElementById('otp_basic_result').textContent = `입력 중: ${value}`;
  }
});
IMCAT.view.registerInstance(window._otp_basic);

// 구분선 OTP
if (window._otp_separator && window._otp_separator.destroy) window._otp_separator.destroy();
window._otp_separator = new OTPInput('#otp_separator', {
  length: 6,
  separator: true,
  separatorPosition: 3,
  onComplete: (value) => {
    document.getElementById('otp_separator_result').innerHTML = `<span style="color: var(--success-color);">✓ 입력 완료: ${value}</span>`;
  }
});
IMCAT.view.registerInstance(window._otp_separator);

// 4자리 OTP
if (window._otp_short && window._otp_short.destroy) window._otp_short.destroy();
window._otp_short = new OTPInput('#otp_short', {
  length: 4,
  onComplete: (value) => {
    document.getElementById('otp_short_result').innerHTML = `<span style="color: var(--success-color);">✓ 입력 완료: ${value}</span>`;
  }
});
IMCAT.view.registerInstance(window._otp_short);

// 마스킹 OTP
if (window._otp_masked && window._otp_masked.destroy) window._otp_masked.destroy();
window._otp_masked = new OTPInput('#otp_masked', {
  length: 6,
  mask: true,
  onComplete: (value) => {
    document.getElementById('otp_masked_result').innerHTML = `<span style="color: var(--success-color);">✓ 입력 완료</span>`;
  }
});
IMCAT.view.registerInstance(window._otp_masked);

// 에러 OTP
if (window._otp_error && window._otp_error.destroy) window._otp_error.destroy();
window._otp_error = new OTPInput('#otp_error', {
  length: 6
});
IMCAT.view.registerInstance(window._otp_error);

window.demo_otp_setError = function() {
  window._otp_error.setError('인증 코드가 올바르지 않습니다.');
};
window.demo_otp_clearError = function() {
  window._otp_error.clearError();
};

// 비활성화 OTP
if (window._otp_disabled && window._otp_disabled.destroy) window._otp_disabled.destroy();
window._otp_disabled = new OTPInput('#otp_disabled', {
  length: 6,
  disabled: true
});
window._otp_disabled.setValue('123456');
IMCAT.view.registerInstance(window._otp_disabled);

// ====================
// PIN 예제
// ====================

// 기본 PIN
if (window._pin_basic && window._pin_basic.destroy) window._pin_basic.destroy();
window._pin_basic = new PinInput('#pin_basic', {
  length: 4,
  onComplete: (value) => {
    document.getElementById('pin_basic_result').innerHTML = `<span style="color: var(--success-color);">✓ PIN 입력 완료</span>`;
  }
});
IMCAT.view.registerInstance(window._pin_basic);

// 6자리 PIN
if (window._pin_long && window._pin_long.destroy) window._pin_long.destroy();
window._pin_long = new PinInput('#pin_long', {
  length: 6,
  onComplete: (value) => {
    document.getElementById('pin_long_result').innerHTML = `<span style="color: var(--success-color);">✓ PIN 입력 완료</span>`;
  }
});
IMCAT.view.registerInstance(window._pin_long);

// 가상 키패드
if (window._pin_keypad && window._pin_keypad.destroy) window._pin_keypad.destroy();
window._pin_keypad = new PinInput('#pin_keypad', {
  length: 4,
  keypad: true,
  onComplete: (value) => {
    document.getElementById('pin_keypad_result').innerHTML = `<span style="color: var(--success-color);">✓ PIN 입력 완료</span>`;
  }
});
IMCAT.view.registerInstance(window._pin_keypad);

// 셔플 키패드
if (window._pin_shuffle && window._pin_shuffle.destroy) window._pin_shuffle.destroy();
window._pin_shuffle = new PinInput('#pin_shuffle', {
  length: 4,
  keypad: true,
  shuffleKeypad: true,
  onComplete: (value) => {
    document.getElementById('pin_shuffle_result').innerHTML = `<span style="color: var(--success-color);">✓ PIN 입력 완료</span>`;
  }
});
IMCAT.view.registerInstance(window._pin_shuffle);

window.demo_pin_reshuffle = function() {
  window._pin_shuffle.shuffleKeypad();
  window._pin_shuffle.clear();
};

// ====================
// 실전 예제
// ====================

// SMS 인증
if (window._demo_sms && window._demo_sms.destroy) window._demo_sms.destroy();
window._demo_sms = new OTPInput('#demo_sms_otp', {
  length: 6,
  onComplete: (value) => {
    document.getElementById('demo_sms_status').innerHTML = 
      `<span style="color: var(--success-color);"><i class="material-icons-outlined" style="vertical-align: middle;">check_circle</i> 인증이 완료되었습니다!</span>`;
  }
});
IMCAT.view.registerInstance(window._demo_sms);

window.demo_resend_sms = function() {
  window._demo_sms.clear();
  document.getElementById('demo_sms_status').innerHTML = 
    `<span style="color: var(--info-color);">인증번호가 재전송되었습니다.</span>`;
};

// 결제 비밀번호
if (window._demo_payment && window._demo_payment.destroy) window._demo_payment.destroy();
window._demo_payment = new PinInput('#demo_payment_pin', {
  length: 6,
  keypad: true,
  shuffleKeypad: true,
  onComplete: (value) => {
    document.getElementById('demo_payment_status').innerHTML = 
      `<span style="color: var(--success-color);"><i class="material-icons-outlined" style="vertical-align: middle;">check_circle</i> 결제가 승인되었습니다!</span>`;
  }
});
IMCAT.view.registerInstance(window._demo_payment);
</script>
